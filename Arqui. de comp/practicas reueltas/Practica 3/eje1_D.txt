PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H
TIMER EQU 25H
CONT EQU 10H
COMP EQU 11H 
IMR EQU 21H
EOI EQU 20H
TEMP EQU 10 ; | ID | VALOR QUE SE VA A MULTIPLICAR POR 4 MAS ADELANTE  

ORG 40 
IP_TEMP DW RUT_TIMER

ORG 3000H
RUT_TIMER: INC PATRON 
           CMP PATRON, 11111111B ; SI LLEGO AL FINAL 
           JNZ LUCES 
           MOV FINAL, 1 ; AVISA QUE YA TERMINA 
           MOV AL, 11111111B ;DESHABILITA TODAS LAS INT MEDIANTE EL IMR 
           OUT IMR, AL
           JMP FIN 
LUCES: MOV AL, PATRON
       OUT PB, AL ; ACTUALIZA LAS LUCES , LAS VA PRNEDIENDO DE A UNA
       
       ;RESETEA EL TIMER, EMPIEZA OTRA VEZ EN 0s 
       
       MOV AL, 0 
       OUT CONT, AL 
FIN:  MOV AL, 20H
      OUT EOI, AL 
     

IRET

ORG 1000H
PATRON DB 0
FINAL DB 0

ORG 2000H
; CONF IMR 
MOV AL, 11111101B ; HABILITO INT TIMER
OUT IMR, AL 

; CONF ID INT

MOV AL, 10
OUT TIMER, AL

; CONF CONT | INICIALIZO EN 0|
MOV AL, 0
OUT CONT, AL 

; CONF COMP | NOS PIDE QUE COMPARE CADA 1 SEG|
MOV AL, 1
OUT COMP, AL 

; INICIALIZA LAS LLAVES Y LUCES TODAS APAGADAS 

MOV AL, 0
OUT CA, AL
OUT CB, AL 


; CONF LLAVES

 MOV AL, 11111111B ; PA entradas (Llaves)
 OUT CA, AL
 
; CONF LUCES 
MOV AL, 00000000B ; PB salidas (Luces)
OUT CB, AL

LAZO: CMP FINAL, 1 
      JNZ LAZO


HLT
END

