PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H 

ORG 1000H
MSJ DB " VICEN TU MAMA "
    DB " ESTA RE LINDA "
    
FIN DB ? 

ORG 2000H 
; CONF CA CON 1111 1101 
 MOV AL, 11111101B
 OUT CA, AL     ; CA = REGUSTRO DE ESTADO  
 
 ; CONV CB
 MOV AL, 00000000B
 OUT CB, AL
 
 ; CONF STROB 
IN AL, PA
AND AL, 11111101B ; FUERZO A 0 
OUT PA, AL 

; CONF PARA IMPRIMIR
MOV BX, OFFSET MSJ
MOV CL, OFFSET FIN- OFFSET MSJ ; CL CONTADOR DE CARACTERES 

; EN ESTE LAZO, VOY A ESTAR PREGUNTANDO CONSTANTEMENTE SI 
; LA IMPRESORA ESTA LIBRE 
; PREGUNTAMOS ESTADO DE IMPRESORA 
POLL: IN AL ,PA ; CARGA EL VALOR DE PA (1111 1101) EN AL 
      AND AL, 1 ; 1 OCUPADA |||| 0 LIBRE 
      JNZ POLL ; SI NO DIO 0, ESTA OCUPADA, VUELVE A PREGUNTAR EL ESTADO

; SI DA 0, ENTONCES ESTA LIBRE, Y SEGUIMOS EJECUTANDO
; ENVIO UN CAR A LA IMORESORA
MOV AL, [BX]
OUT PB, AL

; PULSO DE STROBE 
 IN AL, PA ; PA AHORA TIENE 1111 1101
 OR AL, 00000010B ; FUERZO STROBE A 1  
 OUT PA, AL 
 
 ; REINICIO STROBE 
 IN AL, PA 
 AND AL, 11111101B ; FUERZO STROB A 0
 OUT PA, AL
 
 INC BX ; VOY AL SIG CARACTER 
 DEC CL ; CONTADOR DE CARACTERES
 JNZ POLL ; SI NO LLEGUE AL ULT CARACTER, VUELVO AL LAZO
 INT 0
 END
 